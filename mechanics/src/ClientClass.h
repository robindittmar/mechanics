/// 
/// Source Engine declarations
///

#ifndef __CLIENTCLASS_H__
#define __CLIENTCLASS_H__

#include <Windows.h>

//enum eClientClassId
//{
//	CAI_BaseNPC = 0,
//	CAK47 = 1,
//	CBaseAnimatingClassId = 2,
//	CBaseAnimatingOverlay = 3,
//	CBaseAttributableItemClientClass = 4,
//	CBaseButton = 5,
//	CBaseCombatCharacter = 6,
//	CBaseCombatWeapon = 7,
//	CBaseCSGrenade = 8,
//	CBaseCSGrenadeProjectile = 9,
//	CBaseDoor = 10,
//	CBaseEntity = 11,
//	CBaseFlex = 12,
//	CBaseGrenade = 13,
//	CBaseParticleEntity = 14,
//	CBasePlayer = 15,
//	CBasePropDoor = 16,
//	CBaseTeamObjectiveResource = 17,
//	CBaseTempEntity = 18,
//	CBaseToggle = 19,
//	CBaseTrigger = 20,
//	CBaseViewModelClientClass = 21,
//	CBaseVPhysicsTrigger = 22,
//	CBaseWeaponWorldModel = 23,
//	CBeam = 24,
//	CBeamSpotlight = 25,
//	CBoneFollower = 26,
//	CBreakableProp = 27,
//	CBreakableSurface = 28,
//	CC4 = 29,
//	CCascadeLight = 30,
//	CChicken = 31,
//	CColorCorrection = 32,
//	CColorCorrectionVolume = 33,
//	CCSGameRulesProxy = 34,
//	CCSPlayer = 35,
//	CCSPlayerResource = 36,
//	CCSRagdoll = 37,
//	CCSTeam = 38,
//	CDEagle = 39,
//	CDecoyGrenade = 40,
//	CDecoyProjectile = 41,
//	CDynamicLight = 42,
//	CDynamicProp = 43,
//	CEconEntity = 44,
//	CEconWearable = 45,
//	CEmbers = 46,
//	CEntityDissolve = 47,
//	CEntityFlame = 48,
//	CEntityFreezing = 49,
//	CEntityParticleTrail = 50,
//	CEnvAmbientLight = 51,
//	CEnvDetailController = 52,
//	CEnvDOFController = 53,
//	CEnvParticleScript = 54,
//	CEnvProjectedTexture = 55,
//	CEnvQuadraticBeam = 56,
//	CEnvScreenEffect = 57,
//	CEnvScreenOverlay = 58,
//	CEnvTonemapController = 59,
//	CEnvWind = 60,
//	CFEPlayerDecal = 61,
//	CFireCrackerBlast = 62,
//	CFireSmoke = 63,
//	CFireTrail = 64,
//	CFish = 65,
//	CFlashbang = 66,
//	CFogController = 67,
//	CFootstepControl = 68,
//	CFunc_Dust = 69,
//	CFunc_LOD = 70,
//	CFuncAreaPortalWindow = 71,
//	CFuncBrush = 72,
//	CFuncConveyor = 73,
//	CFuncLadder = 74,
//	CFuncMonitor = 75,
//	CFuncMoveLinear = 76,
//	CFuncOccluder = 77,
//	CFuncReflectiveGlass = 78,
//	CFuncRotating = 79,
//	CFuncSmokeVolume = 80,
//	CFuncTrackTrain = 81,
//	CGameRulesProxy = 82,
//	CHandleTest = 83,
//	CHEGrenade = 84,
//	CHostage = 85,
//	CHostageCarriableProp = 86,
//	CIncendiaryGrenade = 87,
//	CInferno = 88,
//	CInfoLadderDismount = 89,
//	CInfoOverlayAccessor = 90,
//	CItem_Healthshot = 91,
//	CItemDogtags = 92,
//	CKnife = 93,
//	CKnifeGG = 94,
//	CLightGlow = 95,
//	CMaterialModifyControl = 96,
//	CMolotovGrenade = 97,
//	CMolotovProjectile = 98,
//	CMovieDisplay = 99,
//	CParticleFire = 100,
//	CParticlePerformanceMonitor = 101,
//	CParticleSystem = 102,
//	CPhysBox = 103,
//	CPhysBoxMultiplayer = 104,
//	CPhysicsProp = 105,
//	CPhysicsPropMultiplayer = 106,
//	CPhysMagnet = 107,
//	CPlantedC4 = 108,
//	CPlasma = 109,
//	CPlayerResource = 110,
//	CPointCamera = 111,
//	CPointCommentaryNode = 112,
//	CPointWorldText = 113,
//	CPoseController = 114,
//	CPostProcessController = 115,
//	CPrecipitation = 116,
//	CPrecipitationBlocker = 117,
//	CPredictedViewModel = 118,
//	CProp_Hallucination = 119,
//	CPropDoorRotating = 120,
//	CPropJeep = 121,
//	CPropVehicleDriveable = 122,
//	CRagdollManager = 123,
//	CRagdollProp = 124,
//	CRagdollPropAttached = 125,
//	CRopeKeyframe = 126,
//	CSCAR17 = 127,
//	CSceneEntity = 128,
//	CSensorGrenade = 129,
//	CSensorGrenadeProjectile = 130,
//	CShadowControl = 131,
//	CSlideshowDisplay = 132,
//	CSmokeGrenade = 133,
//	CSmokeGrenadeProjectile = 134,
//	CSmokeStack = 135,
//	CSpatialEntity = 136,
//	CSpotlightEnd = 137,
//	CSprite = 138,
//	CSpriteOriented = 139,
//	CSpriteTrail = 140,
//	CStatueProp = 141,
//	CSteamJet = 142,
//	CSun = 143,
//	CSunlightShadowControl = 144,
//	CTeam = 145,
//	CTeamplayRoundBasedRulesProxy = 146,
//	CTEArmorRicochet = 147,
//	CTEBaseBeam = 148,
//	CTEBeamEntPoint = 149,
//	CTEBeamEnts = 150,
//	CTEBeamFollow = 151,
//	CTEBeamLaser = 152,
//	CTEBeamPoints = 153,
//	CTEBeamRing = 154,
//	CTEBeamRingPoint = 155,
//	CTEBeamSpline = 156,
//	CTEBloodSprite = 157,
//	CTEBloodStream = 158,
//	CTEBreakModel = 159,
//	CTEBSPDecal = 160,
//	CTEBubbles = 161,
//	CTEBubbleTrail = 162,
//	CTEClientProjectile = 163,
//	CTEDecal = 164,
//	CTEDust = 165,
//	CTEDynamicLight = 166,
//	CTEEffectDispatch = 167,
//	CTEEnergySplash = 168,
//	CTEExplosion = 169,
//	CTEFireBullets = 170,
//	CTEFizz = 171,
//	CTEFootprintDecal = 172,
//	CTEFoundryHelpers = 173,
//	CTEGaussExplosion = 174,
//	CTEGlowSprite = 175,
//	CTEImpact = 176,
//	CTEKillPlayerAttachments = 177,
//	CTELargeFunnel = 178,
//	CTEMetalSparks = 179,
//	CTEMuzzleFlash = 180,
//	CTEParticleSystem = 181,
//	CTEPhysicsProp = 182,
//	CTEPlantBomb = 183,
//	CTEPlayerAnimEvent = 184,
//	CTEPlayerDecal = 185,
//	CTEProjectedDecal = 186,
//	CTERadioIcon = 187,
//	CTEShatterSurface = 188,
//	CTEShowLine = 189,
//	CTesla = 190,
//	CTESmoke = 191,
//	CTESparks = 192,
//	CTESprite = 193,
//	CTESpriteSpray = 194,
//	CTest_ProxyToggle_Networkable = 195,
//	CTestTraceline = 196,
//	CTEWorldDecal = 197,
//	CTriggerPlayerMovement = 198,
//	CTriggerSoundOperator = 199,
//	CVGuiScreen = 200,
//	CVoteController = 201,
//	CWaterBullet = 202,
//	CWaterLODControl = 203,
//	CWeaponAug = 204,
//	CWeaponAWP = 205,
//	CWeaponBaseItem = 206,
//	CWeaponBizon = 207,
//	CWeaponCSBase = 208,
//	CWeaponCSBaseGun = 209,
//	CWeaponCycler = 210,
//	CWeaponElite = 211,
//	CWeaponFamas = 212,
//	CWeaponFiveSeven = 213,
//	CWeaponG3SG1 = 214,
//	CWeaponGalil = 215,
//	CWeaponGalilAR = 216,
//	CWeaponGlock = 217,
//	CWeaponHKP2000 = 218,
//	CWeaponM249 = 219,
//	CWeaponM3 = 220,
//	CWeaponM4A1 = 221,
//	CWeaponMAC10 = 222,
//	CWeaponMag7 = 223,
//	CWeaponMP5Navy = 224,
//	CWeaponMP7 = 225,
//	CWeaponMP9 = 226,
//	CWeaponNegev = 227,
//	CWeaponNOVA = 228,
//	CWeaponP228 = 229,
//	CWeaponP250 = 230,
//	CWeaponP90 = 231,
//	CWeaponSawedoff = 232,
//	CWeaponSCAR20 = 233,
//	CWeaponScout = 234,
//	CWeaponSG550 = 235,
//	CWeaponSG552 = 236,
//	CWeaponSG556 = 237,
//	CWeaponSSG08 = 238,
//	CWeaponTaser = 239,
//	CWeaponTec9 = 240,
//	CWeaponTMP = 241,
//	CWeaponUMP45 = 242,
//	CWeaponUSP = 243,
//	CWeaponXM1014 = 244,
//	CWorld = 245,
//	DustTrail = 246,
//	MovieExplosion = 247,
//	ParticleSmokeGrenade = 248,
//	RocketTrail = 249,
//	SmokeTrail = 250,
//	SporeExplosion = 251,
//	SporeTrail = 252
//};

enum eClientClassId {
	CAI_BaseNPC = 0,
	CAK47,
	CBaseAnimating,
	CBaseAnimatingOverlay,
	CBaseAttributableItemClientClass,
	CBaseButton,
	CBaseCombatCharacter,
	CBaseCombatWeapon,
	CBaseCSGrenade,
	CBaseCSGrenadeProjectile,
	CBaseDoor,
	CBaseEntity,
	CBaseFlex,
	CBaseGrenade,
	CBaseParticleEntity,
	CBasePlayer,
	CBasePropDoor,
	CBaseTeamObjectiveResource,
	CBaseTempEntity,
	CBaseToggle,
	CBaseTrigger,
	CBaseViewModelClientClass,
	CBaseVPhysicsTrigger,
	CBaseWeaponWorldModel,
	CBeam,
	CBeamSpotlight,
	CBoneFollower,
	CBRC4Target,
	CBreachCharge,
	CBreachChargeProjectile,
	CBreakableProp,
	CBreakableSurface,
	CBumpMine,
	CBumpMineProjectile,
	CC4,
	CCascadeLight,
	CChicken,
	CColorCorrection,
	CColorCorrectionVolume,
	CCSGameRulesProxy,
	CCSPlayer,
	CCSPlayerResource,
	CCSRagdoll,
	CCSTeam,
	CDangerZone,
	CDangerZoneController,
	CDEagle,
	CDecoyGrenade,
	CDecoyProjectile,
	CDrone,
	CDronegun,
	CDynamicLight,
	CDynamicProp,
	CEconEntity,
	CEconWearable,
	CEmbers,
	CEntityDissolve,
	CEntityFlame,
	CEntityFreezing,
	CEntityParticleTrail,
	CEnvAmbientLight,
	CEnvDetailController,
	CEnvDOFController,
	CEnvGasCanister,
	CEnvParticleScript,
	CEnvProjectedTexture,
	CEnvQuadraticBeam,
	CEnvScreenEffect,
	CEnvScreenOverlay,
	CEnvTonemapController,
	CEnvWind,
	CFEPlayerDecal,
	CFireCrackerBlast,
	CFireSmoke,
	CFireTrail,
	CFish,
	CFists,
	CFlashbang,
	CFogController,
	CFootstepControl,
	CFunc_Dust,
	CFunc_LOD,
	CFuncAreaPortalWindow,
	CFuncBrush,
	CFuncConveyor,
	CFuncLadder,
	CFuncMonitor,
	CFuncMoveLinear,
	CFuncOccluder,
	CFuncReflectiveGlass,
	CFuncRotating,
	CFuncSmokeVolume,
	CFuncTrackTrain,
	CGameRulesProxy,
	CGrassBurn,
	CHandleTest,
	CHEGrenade,
	CHostage,
	CHostageCarriableProp,
	CIncendiaryGrenade,
	CInferno,
	CInfoLadderDismount,
	CInfoMapRegion,
	CInfoOverlayAccessor,
	CItem_Healthshot,
	CItemCash,
	CItemDogtags,
	CKnife,
	CKnifeGG,
	CLightGlow,
	CMaterialModifyControl,
	CMelee,
	CMolotovGrenade,
	CMolotovProjectile,
	CMovieDisplay,
	CParadropChopper,
	CParticleFire,
	CParticlePerformanceMonitor,
	CParticleSystem,
	CPhysBox,
	CPhysBoxMultiplayer,
	CPhysicsProp,
	CPhysicsPropMultiplayer,
	CPhysMagnet,
	CPhysPropAmmoBox,
	CPhysPropLootCrate,
	CPhysPropRadarJammer,
	CPhysPropWeaponUpgrade,
	CPlantedC4,
	CPlasma,
	CPlayerPing,
	CPlayerResource,
	CPointCamera,
	CPointCommentaryNode,
	CPointWorldText,
	CPoseController,
	CPostProcessController,
	CPrecipitation,
	CPrecipitationBlocker,
	CPredictedViewModel,
	CProp_Hallucination,
	CPropCounter,
	CPropDoorRotating,
	CPropJeep,
	CPropVehicleDriveable,
	CRagdollManager,
	CRagdollProp,
	CRagdollPropAttached,
	CRopeKeyframe,
	CSCAR17,
	CSceneEntity,
	CSensorGrenade,
	CSensorGrenadeProjectile,
	CShadowControl,
	CSlideshowDisplay,
	CSmokeGrenade,
	CSmokeGrenadeProjectile,
	CSmokeStack,
	CSnowball,
	CSnowballPile,
	CSnowballProjectile,
	CSpatialEntity,
	CSpotlightEnd,
	CSprite,
	CSpriteOriented,
	CSpriteTrail,
	CStatueProp,
	CSteamJet,
	CSun,
	CSunlightShadowControl,
	CSurvivalSpawnChopper,
	CTablet,
	CTeam,
	CTeamplayRoundBasedRulesProxy,
	CTEArmorRicochet,
	CTEBaseBeam,
	CTEBeamEntPoint,
	CTEBeamEnts,
	CTEBeamFollow,
	CTEBeamLaser,
	CTEBeamPoints,
	CTEBeamRing,
	CTEBeamRingPoint,
	CTEBeamSpline,
	CTEBloodSprite,
	CTEBloodStream,
	CTEBreakModel,
	CTEBSPDecal,
	CTEBubbles,
	CTEBubbleTrail,
	CTEClientProjectile,
	CTEDecal,
	CTEDust,
	CTEDynamicLight,
	CTEEffectDispatch,
	CTEEnergySplash,
	CTEExplosion,
	CTEFireBullets,
	CTEFizz,
	CTEFootprintDecal,
	CTEFoundryHelpers,
	CTEGaussExplosion,
	CTEGlowSprite,
	CTEImpact,
	CTEKillPlayerAttachments,
	CTELargeFunnel,
	CTEMetalSparks,
	CTEMuzzleFlash,
	CTEParticleSystem,
	CTEPhysicsProp,
	CTEPlantBomb,
	CTEPlayerAnimEvent,
	CTEPlayerDecal,
	CTEProjectedDecal,
	CTERadioIcon,
	CTEShatterSurface,
	CTEShowLine,
	CTesla,
	CTESmoke,
	CTESparks,
	CTESprite,
	CTESpriteSpray,
	CTest_ProxyToggle_Networkable,
	CTestTraceline,
	CTEWorldDecal,
	CTriggerPlayerMovement,
	CTriggerSoundOperator,
	CVGuiScreen,
	CVoteController,
	CWaterBullet,
	CWaterLODControl,
	CWeaponAug,
	CWeaponAWP,
	CWeaponBaseItem,
	CWeaponBizon,
	CWeaponCSBase,
	CWeaponCSBaseGun,
	CWeaponCycler,
	CWeaponElite,
	CWeaponFamas,
	CWeaponFiveSeven,
	CWeaponG3SG1,
	CWeaponGalil,
	CWeaponGalilAR,
	CWeaponGlock,
	CWeaponHKP2000,
	CWeaponM249,
	CWeaponM3,
	CWeaponM4A1,
	CWeaponMAC10,
	CWeaponMag7,
	CWeaponMP5Navy,
	CWeaponMP7,
	CWeaponMP9,
	CWeaponNegev,
	CWeaponNOVA,
	CWeaponP228,
	CWeaponP250,
	CWeaponP90,
	CWeaponSawedoff,
	CWeaponSCAR20,
	CWeaponScout,
	CWeaponSG550,
	CWeaponSG552,
	CWeaponSG556,
	CWeaponShield,
	CWeaponSSG08,
	CWeaponTaser,
	CWeaponTec9,
	CWeaponTMP,
	CWeaponUMP45,
	CWeaponUSP,
	CWeaponXM1014,
	CWorld,
	CWorldVguiText,
	DustTrail,
	MovieExplosion,
	ParticleSmokeGrenade,
	RocketTrail,
	SmokeTrail,
	SporeExplosion,
	SporeTrail
};

enum class SendPropType {
	DPT_Int = 0,
	DPT_Float,
	DPT_Vector,
	DPT_VectorXY, // Only encodes the XY of a vector, ignores Z
	DPT_String,
	DPT_Array,     // An array of the base types (can't be of datatables).
	DPT_DataTable,
	DPT_Int64,
	DPT_NUMSendPropTypes
};

class RecvProp;
class RecvTable {
public:
	RecvProp *m_pProps;
	int m_nProps;
	void *m_pDecoder;
	char *m_pNetTableName;
	bool m_bInitialized;
	bool m_bInMainList;
};

struct DVariant {
	union {
		float m_Float;
		long m_Int;
		char* m_pString;
		void* m_pData;
		float m_Vector[3];
		__int64 m_Int64;
	};

	int	m_Type;
};

struct CRecvProxyData {
	const RecvProp* m_pRecvProp;
	DVariant m_Value;
	int m_iElement;
	int m_ObjectID;
};

class RecvProp {
public:
	char *m_pVarName;
	SendPropType m_RecvType;
	int m_Flags;
	int m_StringBufferSize;
	bool m_bInsideArray;
	const void *m_pExtraData;
	RecvProp *m_pArrayProp;
	void *m_ArrayLengthProxy;
	void *m_ProxyFn;
	void *m_DataTableProxyFn;
	RecvTable *m_pDataTable;
	int m_Offset;
	int m_ElementStride;
	int m_nElements;
	const char *m_pParentArrayPropName;
};

class ClientClass {
public:
	void *m_pCreateFn;
	void *m_pCreateEventFn;
	char *m_pNetworkName;
	RecvTable *m_pRecvTable;
	ClientClass *m_pNext;
	int m_ClassID;
	bool IsWeapon();
	bool IsGrenade();
};

#endif // __CLIENTCLASS_H__